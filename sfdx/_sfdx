#compdef sfdx

# 'sfdx commands' outputs all the subscomma, which is super handy.
# But the commands use ':' in the names, which is used by compdef to
# describe the command, so these need to be escaped.
#
# It's a bit slow to run, but it beats duplicating all the comands
# rather than relying on the tool to tell us what it can do.
# To compensate, lazy load into a cached variable prefixed with _ to avoid autocomplete matches.

if [ -z "$_sfdxCommands" ]
then
    _sfdxCommands=( $(sfdx commands | sed -e 's/:/\\:/g') )
fi

_describe 'command' _sfdxCommands
